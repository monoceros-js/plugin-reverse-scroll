var ReverseScrollPlugin=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function i(e,t,n){return(i=o()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&r(i,n.prototype),i}).apply(null,arguments)}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||(o=e,-1===Function.toString.call(o).indexOf("[native code]")))return e;var o;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return i(e,arguments,n(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),r(s,e)})(e)}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return function(){var t,r=n(e);if(o()){var i=n(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return c(this,t)}}function a(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p={base:{reverse:"reverse"},speed:1,debug:!1},ReverseScrollPluginError=function(n){t(ReverseScrollPluginError,n);var r=l(ReverseScrollPluginError);function ReverseScrollPluginError(t,n){var o;return e(this,ReverseScrollPluginError),(o=r.call(this,t)).pluginName=n,o}return ReverseScrollPluginError}(function(n){t(o,n);var r=l(o);function o(t){var n;return e(this,o),(n=r.call(this)).name=n.constructor.name,n.message=t,n}return o}(s(Error)));return function(e,t){var n=this;this.name="ReverseScrollPlugin",this.version="1.0.2",this.cluster=e.createCluster(),this.instances=[],this.dom=this.cluster.resolve("dom"),this.options=this.cluster.resolve("options.create")(this.cluster.resolve("options"),p,t),this.log=this.cluster.resolve("utils.log"),this.logError=function(e){return console.error(e)},this.getScrollTop=function(e){return e.getBoundingClientRect().top},this.updateScroller=function(e){var t=n.instances[e],r=t.el,o=n.getScrollTop(r.closest(n.options.selectors.section)),i=o>0,s=!i&&Math.abs(o)>r.scrollHeight-n.dom.viewport.clientHeight,c=!i&&!s,l=Math.abs(o);if(c){var a=l+l*n.options.speed;t.coordinates.y.current=a,t.coordinates.y.end=l,r.style.transform="translate(0, ".concat(a,"px) translateZ(0)"),t.inView||(n.options.debug&&n.log("ReverseScrollingPlugin: Entered reverse-scrolling element.",n.instances[e]),n.instances[e].inView=!0)}else i&&t.inView?(r.style.transform="translate(0, 0) translateZ(0)",n.options.debug&&n.log("ReverseScrollingPlugin: Left reverse-scrolling instance.",n.instances[e]),n.instances[e].inView=!1):s&&t.inView&&(r.style.transform="translate(0, ".concat(t.coordinates.y.current,"px) translateZ(0)"),n.options.debug&&n.log("ReverseScrollingPlugin: Left reverse-scrolling instance",n.instances[e]),n.instances[e].inView=!1)},this.createScrollerGhost=function(e){var t=document.createElement("div");return t.style.height=e.scrollHeight*(1/n.options.speed)-n.dom.viewport.clientHeight*(1/n.options.speed-1)+"px",e.parentNode.appendChild(t),t},this.initScroller=function(e){var t=e.closest(n.options.selectors.section);if(t)if(a(t.childNodes).filter((function(e){return 1==e.nodeType})).length>1)n.logError(new ReverseScrollPluginError("".concat(n.options.selectors.reverse," should be only child of ").concat(n.options.selectors.section," element. Canceling plugin initialization.")));else{e.style="\n      height: 100%;\n      width: 100%;\n      left: 0;\n      top: 0;\n      position: absolute;\n    ";var r=n.cluster.resolve("monoceros.createInstance");n.instances.push(r(n.options.base.reverse,e));var o=t.scrollHeight>n.dom.viewport.clientHeight?n.dom.viewport.clientHeight:t.scrollHeight;e.style.top=-1*e.scrollHeight+o+"px",n.createScrollerGhost(e,n.dom.viewport)}else n.logError(new ReverseScrollPluginError("Missing ".concat(n.options.selectors.section," parent for ").concat(n.options.selectors.reverse," element. Canceling plugin initialization.")))},this.onScroll=function(){n.instances.forEach((function(e,t){n.updateScroller(t)}))},this.init=function(){(n.options.speed<0||n.options.speed>1)&&(console.warn(new n.ReverseScrollPluginError("options.speed should be a value between 0 and 1. Reverted to 1.")),n.options.speed=1);var e=Array.from(document.querySelectorAll(n.options.selectors.reverse));0!==e.length?(e.forEach((function(e,t){n.initScroller(e,t)})),n.dom.viewport.addEventListener("scroll",n.onScroll)):n.logError(new ReverseScrollPluginError("Missing ".concat(n.options.selectors.reverse," element. Canceling plugin intialization.")))}}}();
